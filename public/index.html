<html>

<head>
  <title>Express</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
</head>

<body>
  <h1>Express</h1>
  <p>Welcome to Socket</p>
  <h4>choose chat-room</h4>
  <button id="gamingBtn">Gaming Chat</button>
  <button id="sportsBtn">Sports Chat</button>
  <button id="musicBtn">Music Chat</button>
  <br>
  <br>
  <br>

  <input id="name" type="text" placeholder="your name">
  <button id="saveBtn">Save name</button>

  <ul id="chat"></ul>

  <form id="form">
    <input id="input" placeholder="type your message" />
    <button>Send</button>
  </form>

  <script src="socket.io/socket.io.js"></script>

  <script>

    const socket = io();

    form = document.getElementById("form");
    input = document.getElementById("input");
    chat = document.getElementById("chat");
    saveBtn = document.getElementById("saveBtn");
    let name = document.getElementById("name");
    let username = "";
    let chatroom = "";
    let gamingBtn = document.getElementById("gamingBtn");
    let sportsBtn = document.getElementById("sportsBtn");
    let musicBtn = document.getElementById("musicBtn");


    gamingBtn.addEventListener("click", function (e) {

      console.log("u wanna talk gaming");
      chatroom = "gaming";
      chat.innerHTML = "";

    });

    sportsBtn.addEventListener("click", function (e) {

      console.log("u wanna talk sports");
      chatroom = "sports"
      chat.innerHTML = "";

    });

    musicBtn.addEventListener("click", function (e) {

      console.log("u wanna talk music");
      chatroom = "music"
      chat.innerHTML = "";

    });

    saveBtn.addEventListener("click", function (e) {
      username = name.value;
      console.log(username);

    });

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      if (input.value && username) {
        socket.emit("chat message", { text: input.value, user: username, room: chatroom });
        input.value = "";
      }
    });

    socket.on("chat message", function (msg) {
      console.log(msg);
      if (msg.room == chatroom) {
        if (msg.user == username) {
          chat.insertAdjacentHTML("beforeend", "<li style='color:red;'> " + msg.user + ": " + msg.text + "</li>");
          return
        }

        chat.insertAdjacentHTML("beforeend", "<li> " + msg.user + ": " + msg.text + "</li>");

      }
    })


  </script>

</body>

</html>